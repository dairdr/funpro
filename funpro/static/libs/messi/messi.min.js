function Messi(e,b){var g=this;g.options=jQuery.extend({},Messi.prototype.options,b||{});g.messi=jQuery(g.template);g.setContent(e);if(g.options.title==null){jQuery(".messi-titlebox",g.messi).remove()}else{jQuery(".messi-title",g.messi).append(g.options.title);if(g.options.buttons.length===0&&!g.options.autoclose){if(g.options.closeButton){var f=jQuery('<span class="messi-closebtn"></span>');f.bind("click",function(){g.hide()});jQuery(".messi-titlebox",this.messi).prepend(f)}}if(g.options.titleClass!=null){jQuery(".messi-titlebox",this.messi).addClass(g.options.titleClass)}}if(g.options.width!=null){jQuery(".messi-box",g.messi).css("width",g.options.width)}if(g.options.buttons.length>0){for(var d=0;d<g.options.buttons.length;d++){var a=(g.options.buttons[d]["class"])?g.options.buttons[d]["class"]:"";var c=jQuery('<div class="btnbox"><button class="btn '+a+'" href="#">'+g.options.buttons[d].label+"</button></div>").data("value",g.options.buttons[d].val);c.on("click","button",function(){var h=jQuery.data(this,"value");var i=(g.options.callback!=null)?function(){g.options.callback(h)}:null;g.hide(i)});jQuery(".messi-actions",this.messi).append(c)}}else{jQuery(".messi-footbox",this.messi).remove()}if(g.options.buttons.length===0&&g.options.title==null&&!g.options.autoclose){if(g.options.closeButton){var f=jQuery('<span class="messi-closebtn"></span>');f.bind("click",function(){g.hide()});jQuery(".messi-content",this.messi).prepend(f)}}g.modal=(g.options.modal)?jQuery('<div class="messi-modal"></div>').css({opacity:g.options.modalOpacity,width:jQuery(document).width(),height:jQuery(document).height(),"z-index":g.options.zIndex+jQuery(".messi").length}).appendTo(document.body):null;if(g.options.show){g.show()}jQuery(window).bind("resize",function(){g.resize()});if(g.options.autoclose!=null){setTimeout(function(h){h.hide()},g.options.autoclose,this)}return g}Messi.prototype={options:{autoclose:null,buttons:[],callback:null,center:true,closeButton:true,height:"auto",title:null,titleClass:null,modal:false,modalOpacity:0.2,padding:"10px",show:true,unload:true,viewport:{top:"0px",left:"0px"},width:"500px",zIndex:99999},template:'<div class="messi"><div class="messi-box"><div class="messi-wrapper"><div class="messi-titlebox"><span class="messi-title"></span></div><div class="messi-content"></div><div class="messi-footbox"><div class="messi-actions"></div></div></div></div></div>',content:"<div></div>",visible:false,setContent:function(a){jQuery(".messi-content",this.messi).css({padding:this.options.padding,height:this.options.height}).empty().append(a)},viewport:function(){return{top:((jQuery(window).height()-this.messi.height())/2)+jQuery(window).scrollTop()+"px",left:((jQuery(window).width()-this.messi.width())/2)+jQuery(window).scrollLeft()+"px"}},show:function(){if(this.visible){return}if(this.options.modal&&this.modal!=null){this.modal.show()}this.messi.appendTo(document.body);if(this.options.center){this.options.viewport=this.viewport(jQuery(".messi-box",this.messi))}this.messi.css({top:this.options.viewport.top,left:this.options.viewport.left,"z-index":this.options.zIndex+jQuery(".messi").length}).show().animate({opacity:1},300);this.visible=true},hide:function(a){if(!this.visible){return}var b=this;this.messi.animate({opacity:0},300,function(){if(b.options.modal&&b.modal!=null){b.modal.remove()}b.messi.css({display:"none"}).remove();b.visible=false;if(a){a.call()}if(b.options.unload){b.unload()}});return this},resize:function(){if(this.options.modal){jQuery(".messi-modal").css({width:jQuery(document).width(),height:jQuery(document).height()})}if(this.options.center){this.options.viewport=this.viewport(jQuery(".messi-box",this.messi));this.messi.css({top:this.options.viewport.top,left:this.options.viewport.left})}},toggle:function(){this[this.visible?"hide":"show"]();return this},unload:function(){if(this.visible){this.hide()}jQuery(window).unbind("resize",function(){this.resize()});this.messi.remove()},};jQuery.extend(Messi,{alert:function(c,d,a){var b=[{id:"ok",label:"OK",val:"OK"}];a=jQuery.extend({closeButton:false,buttons:b,callback:function(){}},a||{},{show:true,unload:true,callback:d});return new Messi(c,a)},ask:function(c,d,a){var b=[{id:"yes",label:"Yes",val:"Y","class":"btn-success"},{id:"no",label:"No",val:"N","class":"btn-danger"},];a=jQuery.extend({closeButton:false,modal:true,buttons:b,callback:function(){}},a||{},{show:true,unload:true,callback:d});return new Messi(c,a)},img:function(c,b){var a=new Image();jQuery(a).load(function(){var d={width:jQuery(window).width()-50,height:jQuery(window).height()-50};var e=(this.width>d.width||this.height>d.height)?Math.min(d.width/this.width,d.height/this.height):1;jQuery(a).css({width:this.width*e,height:this.height*e});b=jQuery.extend(b||{},{show:true,unload:true,closeButton:true,width:this.width*e,height:this.height*e,padding:0});new Messi(a,b)}).error(function(){console.log("Error loading "+c)}).attr("src",c)},load:function(b,a){a=jQuery.extend(a||{},{show:true,unload:true,params:{}});var c={url:b,data:a.params,dataType:"html",cache:false,error:function(f,d,e){console.log(f.responseText)},success:function(d){new Messi(d,a)}};jQuery.ajax(c)}});